Running job 2vsm_nanob

Using dataset artifact: /root/.cache/huggingface/hub/datasets--boltzgen--inference-data/snapshots/c3d36fd276e9caf098c75d4113c6d5eb320b1a4c/mols.zip
************** Checking design spec: /home/ubuntu/inputs/design_spec.yaml **************

Chain ids in non-file sequence conflict with existing chain ids. Renaming them {'A': 'B'}.
Total designed residues: 148
Design specification visualization is written to /home/ubuntu/inputs/design_spec.cif
****************************************************************************************
/root/micromamba/envs/boltzgen/lib/python3.12/site-packages/torch/__init__.py:1617: UserWarning: Please use the new API settings to control TF32 behavior, such as torch.backends.cudnn.conv.fp32_precision = 'tf32' or torch.backends.cuda.matmul.fp32_precision = 'ieee'. Old settings, e.g, torch.backends.cuda.matmul.allow_tf32 = True, torch.backends.cudnn.allow_tf32 = True, allowTF32CuDNN() and allowTF32CuBLAS() will be deprecated after Pytorch 2.9. Please see https://pytorch.org/docs/main/notes/cuda.html#tensorfloat-32-tf32-on-ampere-and-later-devices (Triggered internally at /pytorch/aten/src/ATen/Context.cpp:80.)
  _C._set_float32_matmul_precision(precision)

Predicting: |          | 0/? [00:00<?, ?it/s]
[Step 1/5] design - Predicting: |          | 0/? [00:00<?, ?it/s]
[Step 1/5] design - Predicting: |          | 0/? [00:00<?, ?it/s]
Predicting DataLoader 0:   0%|          | 0/10 [00:00<?, ?it/s]  
[Step 1/5] design - Predicting DataLoader 0: :   0%|          | 0/10 [00:00<?, ?it/s]W1031 13:40:21.255000 2325 site-packages/torch/fx/_symbolic_trace.py:52] is_fx_tracing will return true for both fx.symbolic_trace and torch.export. Please use is_fx_tracing_symbolic_tracing() for specifically fx.symbolic_trace or torch.compiler.is_compiling() for specifically torch.export/compile.

[Step 1/5] design - Predicting DataLoader 0: :  10%|█         | 1/10 [01:51<16:44,  0.01it/s]
[Step 1/5] design - Predicting DataLoader 0: :  20%|██        | 2/10 [02:17<09:08,  0.01it/s]Switched step_scale to 2.0
Switched noise_scale to 0.88

[Step 1/5] design - Predicting DataLoader 0: :  30%|███       | 3/10 [02:41<06:17,  0.02it/s]
[Step 1/5] design - Predicting DataLoader 0: :  40%|████      | 4/10 [03:06<04:40,  0.02it/s]
[Step 1/5] design - Predicting DataLoader 0: :  50%|█████     | 5/10 [03:30<03:30,  0.02it/s]Loaded weights from /root/.cache/huggingface/hub/models--boltzgen--boltzgen1_adherence/snapshots/c9504767050696f03ba93fd19a000c3fea55b78b/boltzgen1_adherence.ckpt
Switched checkpoint.

[Step 1/5] design - Predicting DataLoader 0: :  60%|██████    | 6/10 [08:17<05:31,  0.01it/s]Switched step_scale to 1.8
Switched noise_scale to 0.95

[Step 1/5] design - Predicting DataLoader 0: :  70%|███████   | 7/10 [08:39<03:42,  0.01it/s]
[Step 1/5] design - Predicting DataLoader 0: :  80%|████████  | 8/10 [09:03<02:15,  0.01it/s]Switched step_scale to 2.0
Switched noise_scale to 0.88

[Step 1/5] design - Predicting DataLoader 0: :  90%|█████████ | 9/10 [09:28<01:03,  0.02it/s]
[Step 1/5] design - Predicting DataLoader 0: : 100%|██████████| 10/10 [09:53<00:00,  0.02it/s]Number of failed examples: 0

[Step 1/5] design - Predicting DataLoader 0: : 100%|██████████| 10/10 [09:53<00:00,  0.02it/s]
Chain ids in non-file sequence conflict with existing chain ids. Renaming them {'A': 'B'}.

/root/micromamba/envs/boltzgen/lib/python3.12/site-packages/torch/__init__.py:1551: UserWarning: Please use the new API settings to control TF32 behavior, such as torch.backends.cudnn.conv.fp32_precision = 'tf32' or torch.backends.cuda.matmul.fp32_precision = 'ieee'. Old settings, e.g, torch.backends.cuda.matmul.allow_tf32 = True, torch.backends.cudnn.allow_tf32 = True, allowTF32CuDNN() and allowTF32CuBLAS() will be deprecated after Pytorch 2.9. Please see https://pytorch.org/docs/main/notes/cuda.html#tensorfloat-32-tf32-on-ampere-and-later-devices (Triggered internally at /pytorch/aten/src/ATen/Context.cpp:80.)
  return _C._get_float32_matmul_precision()
Initializing FromGeneratedDataModule datasets for /home/ubuntu/out/intermediate_designs
[Info] Number of files to process (including already processed ones): 10
Found 1 targets and 10 remaining designs that still need to be processed in this step.

Predicting: |          | 0/? [00:00<?, ?it/s]
[Step 2/5] inverse_folding - Predicting: |          | 0/? [00:00<?, ?it/s]
[Step 2/5] inverse_folding - Predicting: |          | 0/? [00:00<?, ?it/s]
Predicting DataLoader 0:   0%|          | 0/10 [00:00<?, ?it/s]           
[Step 2/5] inverse_folding - Predicting DataLoader 0: :   0%|          | 0/10 [00:00<?, ?it/s]
[Step 2/5] inverse_folding - Predicting DataLoader 0: :  10%|█         | 1/10 [00:04<00:43,  0.21it/s]
[Step 2/5] inverse_folding - Predicting DataLoader 0: :  20%|██        | 2/10 [00:05<00:22,  0.35it/s]
[Step 2/5] inverse_folding - Predicting DataLoader 0: :  30%|███       | 3/10 [00:06<00:15,  0.44it/s]
[Step 2/5] inverse_folding - Predicting DataLoader 0: :  40%|████      | 4/10 [00:07<00:11,  0.52it/s]
[Step 2/5] inverse_folding - Predicting DataLoader 0: :  50%|█████     | 5/10 [00:08<00:08,  0.59it/s]
[Step 2/5] inverse_folding - Predicting DataLoader 0: :  60%|██████    | 6/10 [00:09<00:06,  0.62it/s]
[Step 2/5] inverse_folding - Predicting DataLoader 0: :  70%|███████   | 7/10 [00:10<00:04,  0.67it/s]
[Step 2/5] inverse_folding - Predicting DataLoader 0: :  80%|████████  | 8/10 [00:11<00:02,  0.70it/s]
[Step 2/5] inverse_folding - Predicting DataLoader 0: :  90%|█████████ | 9/10 [00:12<00:01,  0.73it/s]
[Step 2/5] inverse_folding - Predicting DataLoader 0: : 100%|██████████| 10/10 [00:13<00:00,  0.76it/s]Number of failed examples: 0

[Step 2/5] inverse_folding - Predicting DataLoader 0: : 100%|██████████| 10/10 [00:13<00:00,  0.76it/s]
/root/micromamba/envs/boltzgen/lib/python3.12/site-packages/torch/__init__.py:1551: UserWarning: Please use the new API settings to control TF32 behavior, such as torch.backends.cudnn.conv.fp32_precision = 'tf32' or torch.backends.cuda.matmul.fp32_precision = 'ieee'. Old settings, e.g, torch.backends.cuda.matmul.allow_tf32 = True, torch.backends.cudnn.allow_tf32 = True, allowTF32CuDNN() and allowTF32CuBLAS() will be deprecated after Pytorch 2.9. Please see https://pytorch.org/docs/main/notes/cuda.html#tensorfloat-32-tf32-on-ampere-and-later-devices (Triggered internally at /pytorch/aten/src/ATen/Context.cpp:80.)
  return _C._get_float32_matmul_precision()
Initializing FromGeneratedDataModule datasets for /home/ubuntu/out/intermediate_designs_inverse_folded
[Info] Number of files to process (including already processed ones): 10
Found 1 targets and 10 remaining designs that still need to be processed in this step.

Predicting: |          | 0/? [00:00<?, ?it/s]
[Step 3/5] folding - Predicting: |          | 0/? [00:00<?, ?it/s]
[Step 3/5] folding - Predicting: |          | 0/? [00:00<?, ?it/s]
Predicting DataLoader 0:   0%|          | 0/10 [00:00<?, ?it/s]   
[Step 3/5] folding - Predicting DataLoader 0: :   0%|          | 0/10 [00:00<?, ?it/s]W1031 13:55:35.449000 2836 site-packages/torch/fx/_symbolic_trace.py:52] is_fx_tracing will return true for both fx.symbolic_trace and torch.export. Please use is_fx_tracing_symbolic_tracing() for specifically fx.symbolic_trace or torch.compiler.is_compiling() for specifically torch.export/compile.

[Step 3/5] folding - Predicting DataLoader 0: :  10%|█         | 1/10 [00:29<04:23,  0.03it/s]
[Step 3/5] folding - Predicting DataLoader 0: :  20%|██        | 2/10 [01:00<04:02,  0.03it/s]
[Step 3/5] folding - Predicting DataLoader 0: :  30%|███       | 3/10 [01:29<03:29,  0.03it/s]
[Step 3/5] folding - Predicting DataLoader 0: :  40%|████      | 4/10 [02:03<03:04,  0.03it/s]
[Step 3/5] folding - Predicting DataLoader 0: :  50%|█████     | 5/10 [02:31<02:31,  0.03it/s]
[Step 3/5] folding - Predicting DataLoader 0: :  60%|██████    | 6/10 [03:01<02:01,  0.03it/s]
[Step 3/5] folding - Predicting DataLoader 0: :  70%|███████   | 7/10 [03:28<01:29,  0.03it/s]
[Step 3/5] folding - Predicting DataLoader 0: :  80%|████████  | 8/10 [03:59<00:59,  0.03it/s]
[Step 3/5] folding - Predicting DataLoader 0: :  90%|█████████ | 9/10 [04:31<00:30,  0.03it/s]
[Step 3/5] folding - Predicting DataLoader 0: : 100%|██████████| 10/10 [05:05<00:00,  0.03it/s]Number of failed structure predictions: 0

[Step 3/5] folding - Predicting DataLoader 0: : 100%|██████████| 10/10 [05:05<00:00,  0.03it/s]
Initializing FromGeneratedDataModule datasets for /home/ubuntu/out/intermediate_designs_inverse_folded
[Info] Number of files to process (including already processed ones): 10
Found 1 targets and 10 remaining designs that still need to be processed in this step.

Processing samples:   0%|          | 0/10 [00:00<?, ?it/s]
Processing samples:  10%|█         | 1/10 [00:13<01:58, 13.20s/it]
Processing samples:  50%|█████     | 5/10 [00:16<00:13,  2.64s/it]
Processing samples:  60%|██████    | 6/10 [00:16<00:08,  2.10s/it]
Processing samples:  80%|████████  | 8/10 [00:16<00:02,  1.32s/it]
Processing samples:  90%|█████████ | 9/10 [00:18<00:01,  1.37s/it]
Processing samples: 100%|██████████| 10/10 [00:18<00:00,  1.08s/it]
Processing samples: 100%|██████████| 10/10 [00:20<00:00,  2.01s/it]
Computed metrics successfully for 10 out of 10.

Loading saved metrics from disk. 1% of total:   0%|          | 0/10 [00:00<?, ?it/s]
Loading saved metrics from disk. 1% of total:  80%|████████  | 8/10 [00:00<00:00, 77.62it/s]
Loading saved metrics from disk. 1% of total: 100%|██████████| 10/10 [00:00<00:00, 77.69it/s]
Number of targets: 1. Number of designs: 10.
Total number of designs:    10
Duplicates found: 0. Removing duplicates. 10 designs remain.

Num designs that pass the has_x filter with threshold 0 where lower is better: 10
Remaining designs: 10
Num designs that pass the filter_rmsd filter with threshold 2.5 where lower is better: 1
Remaining designs: 1
Num designs that pass the filter_rmsd_design filter with threshold 2.5 where lower is better: 3
Remaining designs: 1
Num designs that pass the CYS_fraction filter with threshold 0 where lower is better: 10
Remaining designs: 1
Num designs that pass the ALA_fraction filter with threshold 0.2 where lower is better: 10
Remaining designs: 1
Num designs that pass the GLY_fraction filter with threshold 0.2 where lower is better: 5
Remaining designs: 1
Num designs that pass the GLU_fraction filter with threshold 0.2 where lower is better: 10
Remaining designs: 1
Num designs that pass the LEU_fraction filter with threshold 0.2 where lower is better: 10
Remaining designs: 1
Num designs that pass the VAL_fraction filter with threshold 0.2 where lower is better: 9
Remaining designs: 1
Only 1 designs pass filters. We highly recommend relaxing the thresholds.



Performing lazy greedy diversity optimization.:   0%|          | 0/1 [00:00<?, ?it/s]
Performing lazy greedy diversity optimization.: 100%|██████████| 1/1 [00:00<00:00, 14768.68it/s]

copy top design files: 0it [00:00, ?it/s]
copy top design files: 10it [00:00, 1221.26it/s]

copy diversity files:   0%|          | 0/2 [00:00<?, ?it/s]
copy diversity files: 100%|██████████| 2/2 [00:00<00:00, 1189.37it/s]
Files + CSV saved to /home/ubuntu/out/final_ranked_designs

Writing design files is done. Now making plots for a final summary .pdf file with statistics.
Making liability plots for top 0 sequences.: 0it [00:00, ?it/s]Making liability plots for top 0 sequences.: 0it [00:00, ?it/s]
A description of metrics and summarizing plots was written to: /home/ubuntu/out/final_ranked_designs/results_overview.pdf

=== Configuring pipeline ===
Using dataset artifact: /root/.cache/huggingface/hub/datasets--boltzgen--inference-data/snapshots/c3d36fd276e9caf098c75d4113c6d5eb320b1a4c/mols.zip
************** Checking design spec: /home/ubuntu/inputs/design_spec.yaml **************

Chain ids in non-file sequence conflict with existing chain ids. Renaming them {'A': 'B'}.
Total designed residues: 96
Design specification visualization is written to /home/ubuntu/out/design_spec.cif
****************************************************************************************
Using kernels: True [device capability: (8, 9)]
Config overrides for protocol nanobody-anything: {'analysis': ['largest_hydrophobic=false', 'largest_hydrophobic_refolded=false'], 'filtering': ['filter_cysteine=true']}
Using 1 devices
Raw designs will be saved to: /home/ubuntu/out/intermediate_designs
Using diffusion batch size: 1
Number of diffusion batches: 10
Using model artifact: /root/.cache/huggingface/hub/models--boltzgen--boltzgen1_diverse/snapshots/3e329d90b1063ff871aee8fc9b20f38c69b24cbd/boltzgen1_diverse.ckpt
Using model artifact: /root/.cache/huggingface/hub/models--boltzgen--boltzgen1_adherence/snapshots/c9504767050696f03ba93fd19a000c3fea55b78b/boltzgen1_adherence.ckpt
Inverse fold will avoid the following residues: ['CYS']
Inverse-folded designs will be saved to: /home/ubuntu/out/intermediate_designs_inverse_folded
Using model artifact: /root/.cache/huggingface/hub/models--boltzgen--boltzgen1_ifold/snapshots/2c3dd04cf11bd9054d9de1849d3eea5127ee7625/boltzgen1_ifold.ckpt
Using model artifact: /root/.cache/huggingface/hub/models--boltzgen--boltz2_conf_final/snapshots/553c3aec3af7de9ef725d367d897e5af0379da9c/boltz2_conf_final.ckpt
Final ranked designs will be saved to: /home/ubuntu/out/final_ranked_designs
[1] design                   
[2] inverse_folding          
[3] folding                  
[4] analysis                 
[5] filtering                
Configuration complete. Configs written to /home/ubuntu/out/config
Steps manifest written to /home/ubuntu/out/steps.yaml

=== Executing pipeline ===
**************************************************
Pipeline step 1 of 5: design
Running command: python /home/ubuntu/boltzgen/main.py /home/ubuntu/out/config/design.yaml
✓ Step design completed successfully in 962.9s
**************************************************
Pipeline step 2 of 5: inverse_folding
Running command: python /home/ubuntu/boltzgen/main.py /home/ubuntu/out/config/inverse_folding.yaml
✓ Step inverse_folding completed successfully in 22.7s
**************************************************
Pipeline step 3 of 5: folding
Running command: python /home/ubuntu/boltzgen/main.py /home/ubuntu/out/config/folding.yaml
✓ Step folding completed successfully in 624.4s
**************************************************
Pipeline step 4 of 5: analysis
Running command: python /home/ubuntu/boltzgen/main.py /home/ubuntu/out/config/analysis.yaml
✓ Step analysis completed successfully in 32.9s
**************************************************
Pipeline step 5 of 5: filtering
Running command: python /home/ubuntu/boltzgen/main.py /home/ubuntu/out/config/filtering.yaml
✓ Step filtering completed successfully in 11.6s
